<div class="modal-overlay" (click)="close.emit()">
  <div class="modal-card" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>
        <svg
          class="mono-icon"
          viewBox="0 0 24 24"
          width="20"
          height="20"
          aria-hidden="true"
        >
          <path
            d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"
            fill="currentColor"
          />
        </svg>
        {{
          modalTitle ||
            "Send Fees Reminder to " +
              (student?.student_name || "") +
              "'s Parent"
        }}
      </h2>
      <button class="close-btn" (click)="close.emit()">&times;</button>
    </div>

    <div class="modal-body">
      <div class="student-info">
        <div class="info-row">
          <strong>Student:</strong> {{ student?.student_name }}
        </div>
        <div class="info-row">
          <strong>Parent's Phone:</strong> {{ student?.parent_phone_sms }}
        </div>
      </div>

      <div class="message-section">
        <label for="message">Message</label>
        <textarea
          id="message"
          [(ngModel)]="message"
          rows="6"
          placeholder="Type your message here..."
        ></textarea>
        <div class="message-info">
          <span class="char-count">{{ messageLength }} / 160 characters</span>
          <span class="sms-units"
            >(Consumes {{ smsUnits }} SMS credit{{
              smsUnits !== 1 ? "s" : ""
            }})</span
          >
          <span class="sms-cost">
            - Est. Cost UGX {{ estimatedCost | number : "1.0-0" }}</span
          >
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button type="button" class="cancel-btn" (click)="close.emit()">
        Cancel
      </button>
      <button
        type="button"
        class="send-btn"
        (click)="sendReminder()"
        [disabled]="isSending || !message.trim()"
      >
        <svg
          class="mono-icon"
          viewBox="0 0 24 24"
          width="16"
          height="16"
          aria-hidden="true"
        >
          <path d="M2 21l21-9L2 3v7l15 2-15 2v7z" fill="currentColor" />
        </svg>
        <span *ngIf="!isSending">Send</span>
        <span *ngIf="isSending">Sending...</span>
      </button>
    </div>
  </div>
</div>
