<div class="modal-card">
    <div class="modal-header">
        <h2>Assign Responsibility</h2>
        <button class="close-btn" [mat-dialog-close]="false">&times;</button>
    </div>
    <div class="modal-body">
        <form [formGroup]="assignmentForm" (ngSubmit)="onSubmit()">

            <div class="form-row">
                <div class="form-group">
                    <label>Task</label>
                    <select formControlName="type" required>
                        <option value="subject">Assign Subject</option>
                        <option value="class">Assign as Class Teacher</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Class</label>
                    <select formControlName="class_id" required>
                        <option value="" disabled>Select Class</option>
                        <option *ngFor="let cls of classes" [value]="cls.id">{{cls.name}}</option>
                    </select>
                </div>
            </div>

            <div class="form-row" *ngIf="type === 'subject'">
                <div class="form-group">
                    <label>Subject</label>
                    <select formControlName="subject_id" required>
                        <option value="" disabled>Select Subject</option>
                        <option *ngFor="let sub of subjects" [value]="sub.id">{{sub.name}}</option>
                    </select>
                    <div style="margin-top: 5px;" *ngIf="isLoadingSubjects">
                        <mat-progress-bar mode="indeterminate" class="subject-loader"></mat-progress-bar>
                        <small style="color: #666;">Fetching subjects...</small>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="cancel-btn" [mat-dialog-close]="false">Cancel</button>
                <button type="submit" class="submit-btn"
                    [disabled]="assignmentForm.invalid || isSubmitting || isLoadingSubjects">
                    {{ isSubmitting ? 'Assigning...' : 'Assign' }}
                </button>
            </div>

        </form>
    </div>
</div>